!function(n){var e={};function t(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return n[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=n,t.c=e,t.d=function(n,e,i){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:i})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var o in n)t.d(i,o,function(e){return n[e]}.bind(null,o));return i},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="/bundles/administration/",t(t.s="53b2")}({"53b2":function(n,e,t){"use strict";t.r(e);var i=t("Ehby"),o=t.n(i);Shopware.Component.override("sw-system-config",{template:o.a});var r=t("Nhk4"),s=t("TIkw"),a=t.n(s);t("6ulF");function c(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}var l=function(){function n(e,t){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.apiService=e,this.isSynchronizationInProgress=!1,this.isSynchronizationSuccess=!1,this.date=t}var e,t,i;return e=n,(t=[{key:"scheduleSynchronization",value:function(){var n=this.apiService.scheduleSynchronization();return this.isSynchronizationInProgress=!0,n.then(function(n){this.isSynchronizationSuccess=!!n.data.isScheduled}.bind(this)).catch(function(n){this.isSynchronizationSuccess=!1}.bind(this)).finally(function(){this.isSynchronizationInProgress=!1}.bind(this)),n}},{key:"resetSynchronizationState",value:function(){this.isSynchronizationInProgress=!1,this.isSynchronizationSuccess=!1}}])&&c(e.prototype,t),i&&c(e,i),n}(),u=Shopware,h=u.Component,d=u.Mixin,p=Shopware.Utils.format.date;h.register("klaviyo-historical-events-synchronization-control",{template:a.a,inject:["klaviyoHistoricalEventsSynchronizationApiService","klaviyoSubscribersSynchronizationApiService"],snippets:{"en-GB":r},mixins:[d.getByName("notification")],data:function(){return{historicalEventsJobInteractor:new l(this.klaviyoHistoricalEventsSynchronizationApiService,p),subscribersSynchronizationJobInteractor:new l(this.klaviyoSubscribersSynchronizationApiService,p)}},methods:{scheduleHistoricalEventsSynchronization:function(){this.historicalEventsJobInteractor.scheduleSynchronization().then(function(n){n.data.isScheduled?this.createNotificationSuccess({message:this.$tc("klaviyo_integration_plugin.historical_events_tracking.schedule_synchronization.success")}):"SYNCHRONIZATION_IS_ALREADY_RUNNING"===n.data.errorCode?this.createNotificationWarning({message:this.$tc("klaviyo_integration_plugin.historical_events_tracking.schedule_synchronization.is_running")}):"SYNCHRONIZATION_IS_ALREADY_SCHEDULED"===n.data.errorCode?this.createNotificationWarning({message:this.$tc("klaviyo_integration_plugin.historical_events_tracking.schedule_synchronization.is_scheduled")}):this.createNotificationWarning({message:this.$tc("klaviyo_integration_plugin.historical_events_tracking.schedule_synchronization.failed")})}.bind(this)).catch(function(n){this.createNotificationError({message:this.$tc("klaviyo_integration_plugin.historical_events_tracking.schedule_synchronization.failed")})}.bind(this))},scheduleSubscribersSynchronization:function(){this.subscribersSynchronizationJobInteractor.scheduleSynchronization().then(function(n){n.data.isScheduled?this.createNotificationSuccess({message:this.$tc("klaviyo_integration_plugin.subscribers.schedule_synchronization.success")}):"SYNCHRONIZATION_IS_ALREADY_RUNNING"===n.data.errorCode?this.createNotificationWarning({message:this.$tc("klaviyo_integration_plugin.subscribers.schedule_synchronization.is_running")}):"SYNCHRONIZATION_IS_ALREADY_SCHEDULED"===n.data.errorCode?this.createNotificationWarning({message:this.$tc("klaviyo_integration_plugin.subscribers.schedule_synchronization.is_scheduled")}):this.createNotificationWarning({message:this.$tc("klaviyo_integration_plugin.subscribers.schedule_synchronization.failed")})}.bind(this)).catch(function(){this.createNotificationError({message:this.$tc("klaviyo_integration_plugin.subscribers.schedule_synchronization.failed")})}.bind(this))},resetSubscribersSynchronizationState:function(){this.subscribersSynchronizationJobInteractor.resetSynchronizationState()},resetHistoricalEventsSynchronizationState:function(){this.historicalEventsJobInteractor.resetSynchronizationState()}}});var y=t("c21D"),v=t.n(y);function f(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}Shopware.Component.override("sw-promotion-v2-list",{template:v.a,methods:{getExportUrl:function(){return Shopware.Context.api.apiPath+"/klaviyo/integration/promotion/export"}}});var g=function(){function n(e,t){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.httpClient=e,this.loginService=t,this.name="klaviyoHistoricalEventsSynchronizationApiService"}var e,t,i;return e=n,(t=[{key:"scheduleSynchronization",value:function(){var n=this.getHeaders();return this.httpClient.post("/klaviyo/integration/job/_action/historical-event-tracking/synchronization/schedule",{},{headers:n})}},{key:"getHeaders",value:function(){return{Accept:"application/json",Authorization:"Bearer ".concat(this.loginService.getToken()),"Content-Type":"application/json"}}}])&&f(e.prototype,t),i&&f(e,i),n}();function b(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}var S=function(){function n(e,t){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.httpClient=e,this.loginService=t,this.name="klaviyoSubscribersSynchronizationApiService"}var e,t,i;return e=n,(t=[{key:"scheduleSynchronization",value:function(){var n=this.getHeaders();return this.httpClient.post("/klaviyo/integration/job/_action/subscribers/synchronization/schedule",{},{headers:n})}},{key:"getHeaders",value:function(){return{Accept:"application/json",Authorization:"Bearer ".concat(this.loginService.getToken()),"Content-Type":"application/json"}}}])&&b(e.prototype,t),i&&b(e,i),n}();Shopware.Service().register("klaviyoHistoricalEventsSynchronizationApiService",(function(n){var e=Shopware.Application.getContainer("init");return new g(e.httpClient,n.loginService)})),Shopware.Service().register("klaviyoSubscribersSynchronizationApiService",(function(n){var e=Shopware.Application.getContainer("init");return new S(e.httpClient,n.loginService)}));var m=t("Y5f4"),_=t.n(m),k=t("bead"),z=t.n(k),w=t("wBHK"),N=t.n(w);Shopware.Service("exportTemplateService").registerProductExportTemplate({name:"klaviyo-product-feed",translationKey:"klaviyo_integration_plugin.productComparison.templates.template-label.klaviyo-product-feed",headerTemplate:_.a.trim(),bodyTemplate:z.a,footerTemplate:N.a.trim(),fileName:"klaviyo.xml",encoding:"UTF-8",fileFormat:"xml",generateByCronjob:!1,interval:86400});var C=t("iVK8"),x=t.n(C);Shopware.Component.register("klaviyo-job-listing",{template:x.a,computed:{klaviyoJobTypes:function(){return["od-klaviyo-events-sync-handler","od-klaviyo-cart-event-sync-handler","od-klaviyo-full-order-sync-handler","od-klaviyo-full-subscriber-sync-handler","od-klaviyo-order-event-sync-handler","od-klaviyo-order-sync-handler","od-klaviyo-subscriber-sync-handler"]}},methods:{onRefresh:function(){this.$refs.jobListing.onRefresh()}}});var I=t("gpBq");Shopware.Module.register("klaviyo-plugin",{type:"plugin",title:"klaviyo-job-listing.general.title",description:"klaviyo-job-listing.general.description",color:"#F88962",icon:"default-avatar-multiple",snippets:{"en-GB":I},routes:{index:{component:"klaviyo-job-listing",path:"index"}},navigation:[{id:"klaviyo",label:"klaviyo-job-listing.menu.title",color:"#F88962",icon:"default-avatar-multiple",parent:"sw-marketing",path:"klaviyo.plugin.index",position:100}]})},"6ulF":function(n,e,t){var i=t("G3J2");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);(0,t("SZ7m").default)("51654201",i,!0,{})},Ehby:function(n,e){n.exports="{% block sw_system_config_content_card %}\n    <klaviyo-historical-events-synchronization-control v-if=\"domain==='KlaviyoIntegrationPlugin.config'\">\n    </klaviyo-historical-events-synchronization-control>\n    {% parent %}\n{% endblock %}\n\n{% parent %}\n"},G3J2:function(n,e,t){},Nhk4:function(n){n.exports=JSON.parse('{"klaviyo_integration_plugin":{"not_available":"N/A","subscribers":{"last_synchronization_status":{"finished":"Last Synchronization: {status} ({date})","not_finished":"Last Synchronization: {status}"},"last_success_synchronization":"Last Success Synchronization: {date}","get_synchronization_status":{"failed":"Failed to get Last Subscribers synchronization status"},"schedule_synchronization":{"button_label":"Synchronize subscribers","success":"Subscribers synchronization scheduled","failed":"Subscribers synchronization failed to schedule","is_running":"Subscribers synchronization is already running","is_scheduled":"Subscribers synchronization is already scheduled"}},"historical_events_tracking":{"last_synchronization_status":{"finished":"Last Synchronization: {status} ({date})","not_finished":"Last Synchronization: {status}"},"last_success_synchronization":"Last Success Synchronization: {date}","get_synchronization_status":{"failed":"Failed to get Last Historical Events Tracking synchronization status"},"schedule_synchronization":{"button_label":"Synchronize historical events","success":"Historical events synchronization scheduled","failed":"Historical events synchronization failed to schedule","is_running":"Historical events synchronization is already running","is_scheduled":"Historical events synchronization is already scheduled"}},"promotion":{"exportInKlaviyoFormatButtonLabel":"Export in Klaviyo Format"},"productComparison":{"templates":{"template-label":{"klaviyo-product-feed":"Klaviyo (XML)"}}}}}')},SZ7m:function(n,e,t){"use strict";function i(n,e){for(var t=[],i={},o=0;o<e.length;o++){var r=e[o],s=r[0],a={id:n+":"+o,css:r[1],media:r[2],sourceMap:r[3]};i[s]?i[s].parts.push(a):t.push(i[s]={id:s,parts:[a]})}return t}t.r(e),t.d(e,"default",(function(){return y}));var o="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var r={},s=o&&(document.head||document.getElementsByTagName("head")[0]),a=null,c=0,l=!1,u=function(){},h=null,d="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function y(n,e,t,o){l=t,h=o||{};var s=i(n,e);return v(s),function(e){for(var t=[],o=0;o<s.length;o++){var a=s[o];(c=r[a.id]).refs--,t.push(c)}e?v(s=i(n,e)):s=[];for(o=0;o<t.length;o++){var c;if(0===(c=t[o]).refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete r[c.id]}}}}function v(n){for(var e=0;e<n.length;e++){var t=n[e],i=r[t.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](t.parts[o]);for(;o<t.parts.length;o++)i.parts.push(g(t.parts[o]));i.parts.length>t.parts.length&&(i.parts.length=t.parts.length)}else{var s=[];for(o=0;o<t.parts.length;o++)s.push(g(t.parts[o]));r[t.id]={id:t.id,refs:1,parts:s}}}}function f(){var n=document.createElement("style");return n.type="text/css",s.appendChild(n),n}function g(n){var e,t,i=document.querySelector("style["+d+'~="'+n.id+'"]');if(i){if(l)return u;i.parentNode.removeChild(i)}if(p){var o=c++;i=a||(a=f()),e=m.bind(null,i,o,!1),t=m.bind(null,i,o,!0)}else i=f(),e=_.bind(null,i),t=function(){i.parentNode.removeChild(i)};return e(n),function(i){if(i){if(i.css===n.css&&i.media===n.media&&i.sourceMap===n.sourceMap)return;e(n=i)}else t()}}var b,S=(b=[],function(n,e){return b[n]=e,b.filter(Boolean).join("\n")});function m(n,e,t,i){var o=t?"":i.css;if(n.styleSheet)n.styleSheet.cssText=S(e,o);else{var r=document.createTextNode(o),s=n.childNodes;s[e]&&n.removeChild(s[e]),s.length?n.insertBefore(r,s[e]):n.appendChild(r)}}function _(n,e){var t=e.css,i=e.media,o=e.sourceMap;if(i&&n.setAttribute("media",i),h.ssrId&&n.setAttribute(d,e.id),o&&(t+="\n/*# sourceURL="+o.sources[0]+" */",t+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),n.styleSheet)n.styleSheet.cssText=t;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(t))}}},TIkw:function(n,e){n.exports='<div class="klaviyo-historical-events-synchronization-control-wrapper">\n    <sw-card hero="true">\n        <sw-container columns="1fr 1fr">\n            <sw-card-section>\n                <sw-button-process variant="ghost"\n                                   :isLoading="historicalEventsJobInteractor.isSynchronizationInProgress"\n                                   :processSuccess="historicalEventsJobInteractor.isSynchronizationSuccess"\n                                   @click="scheduleHistoricalEventsSynchronization"\n                                   @process-finish="resetHistoricalEventsSynchronizationState"\n                >\n                    {{ $tc(\'klaviyo_integration_plugin.historical_events_tracking.schedule_synchronization.button_label\') }}\n                </sw-button-process>\n            </sw-card-section>\n            <sw-card-section>\n                <sw-button-process variant="ghost"\n                                   :isLoading="subscribersSynchronizationJobInteractor.isSynchronizationInProgress"\n                                   :processSuccess="subscribersSynchronizationJobInteractor.isSynchronizationSuccess"\n                                   @click="scheduleSubscribersSynchronization"\n                                   @process-finish="resetSubscribersSynchronizationState"\n                >\n                    {{ $tc(\'klaviyo_integration_plugin.subscribers.schedule_synchronization.button_label\') }}\n                </sw-button-process>\n            </sw-card-section>\n        </sw-container>\n    </sw-card>\n</div>\n'},Y5f4:function(n,e){n.exports='<?xml version="1.0" encoding="UTF-8" ?>\n<rss version="2.0" xmlns:g="http://base.google.com/ns/1.0" xmlns:atom="http://www.w3.org/2005/Atom">\n    <Products>\n'},bead:function(n,e){n.exports="<Product>\n    <id>{{ product.productNumber }}</id>\n    <title>{{ product.translated.name|escape }}</title>\n    <link>{{ seoUrl('frontend.detail.page', {'productId': product.id}) }}</link>\n    <description>{{ product.translated.description|escape }}</description>\n    <price>{% set price = product.calculatedPrice %} {% if product.calculatedPrices.count %} {% set price = product.calculatedPrices.last %} {% endif %} {{ price.unitPrice }}</price>\n    <image_link>{{ product.cover.media.url }}</image_link>\n    {%- if product.categories|length > 0 -%}\n        {% set categoryNames = [] %}\n\n        {% for category in product.categories %}\n            {% set categoryNames = categoryNames|merge([category.translated.name]) %}\n        {% endfor %}\n        <categories>{{ categoryNames|join(',')|raw|escape }}</categories>\n    {%- else -%}\n        <categories>n/a</categories>\n    {%- endif -%}\n    <inventory_quantity>{{ product.availableStock }}</inventory_quantity>\n    <inventory_policy>1</inventory_policy>\n</Product>\n"},c21D:function(n,e){n.exports='{% block sw_promotion_v2_list_smart_bar_actions_add %}\n    {% parent %}\n    <sw-button\n            :link="getExportUrl()"\n            variant="primary"\n    >\n        {{ $tc(\'klaviyo_integration_plugin.promotion.exportInKlaviyoFormatButtonLabel\') }}\n    </sw-button>\n{% endblock %}\n\n{% parent %}'},gpBq:function(n){n.exports=JSON.parse('{"klaviyo-job-listing":{"general":{"title":"Job Listing Pages","description":"job-listing"},"menu":{"title":"Klaviyo Job Listing"},"page":{"listing":{"title":"Job Listing","description":"List of Jobs","grid":{"column":{"type":"Type","message":"Message","status":"Status","name":"Name","started-at":"Started at","finished-at":"Finished at","created-at":"Created at"}}},"detail":{"textHeadline":"Job","jobChildrenTitle":"Job Children"}},"actions":{"reschedule-job":{"button":{"label":"Reschedule job"}},"show-messages":{"button":{"label":"Show messages"}}}}}')},iVK8:function(n,e){n.exports='{% block job_listing_page %}\n    <sw-page class="swag-example-list">\n        <template slot="content">\n            <job-listing-index ref="jobListing"\n                               :autoReloadInterval="60000"\n                               :jobTypes="klaviyoJobTypes">\n            </job-listing-index>\n        </template>\n        <template #sidebar>\n            <sw-sidebar>\n                {% block sw_jobs_list_sidebar_refresh %}\n                    <sw-sidebar-item\n                        icon="default-arrow-360-left"\n                        :title="$tc(\'sw-product.list.titleSidebarItemRefresh\')"\n                        @click="onRefresh"\n                    />\n                {% endblock %}\n            </sw-sidebar>\n        </template>\n    </sw-page>\n{% endblock %}\n'},wBHK:function(n,e){n.exports="</Products>\n</rss>\n"}});
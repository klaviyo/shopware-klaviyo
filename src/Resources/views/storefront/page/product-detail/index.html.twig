{% sw_extends '@Storefront/storefront/page/product-detail/index.html.twig' %}

{% block base_content %}
    {{ parent() }}

    {% if page.hasExtension('klaviyoIntegrationPluginExtension') and page.getExtension('klaviyoIntegrationPluginExtension').configuration.trackViewedProduct %}
        {% set extensionData =  page.getExtension('klaviyoIntegrationPluginExtension') %}

        {% set klaviyoComponentOptions = {
                'productInfo': extensionData.productInfo
            }
        %}

        <div style="display: none;" data-klaviyo-product-viewed-event-tracking-component=""
            data-klaviyo-product-viewed-event-tracking-component-options="{{ klaviyoComponentOptions|json_encode }}"></div>
    {% endif %}
{% endblock %}
